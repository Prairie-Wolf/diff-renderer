<html>
    <head>
        <title>DiffRenderer playground.</title>
        <style>
            body {
                margin: 1rem;
            }
            .source, .diff, .result {
                float: left;
                width: 32.3%;
                margin-right: 1%;
                height: 100%;
            }
            .source .render {
                width: 100%;
            }
            .source .output {
                border: 2px solid green;
                margin-top: 1rem;
            }
            .diff .output {
                margin-top: 3.6rem;
                border: 2px solid red;
            }
            .result .output {
                margin-top: 3.6rem;
                border: 2px solid yellow;
            }
            .output {
                overflow: auto;
                width: 100%;
                height: 100%;
            }
            .output .item,
            .output .item2 {
                background: green;
                width: 100%;
                height: 2rem;
                border-bottom: 1px solid red;
            }
            .output .item2 {
                background: orange;
            }
        </style>
        <script src="../dist/diff-renderer.js"></script>
    </head>
    <body>
        <div class="source">
            <h2>New html</h2>
            <button class="render">Render diff</button>
            <textarea class="output"></textarea>
        </div>
        <div class="diff">
            <h2>Diff</h2>
            <pre class="output"></pre>
        </div>
        <div class="result">
            <h2>Rendered view</h2>
            <div class="output"></div>
        </div>

<script id="initial" type="text">
<div class="item">aaa</div>
<div class="item"></div>
<div class="item"></div>
</script>

        <script>
            (function() {
                function $(s) {
                    return document.querySelectorAll(s)
                }

                var sourceEl = $('.source textarea')[0]
                var diffEl = $('.diff .output')[0]
                var resultEl = $('.result .output')[0]
                var renderer = new DiffRenderer(resultEl)

                DiffRenderer.start()

                function update() {
                    /*
                    var oldTree = DiffRenderer.serializeHtml(sourceTextareaEl.value).children
                    var newTree = DiffRenderer.serializeHtml(sourceEl.value).children
                    DiffRenderer.utils.decycle(oldTree)
                    DiffRenderer.utils.decycle(newTree)
                    var diff = DiffRenderer.docdiff(oldTree, newTree)
                    diffEl.innerHTML = JSON.stringify(diff, null, '  ')
*/
                    renderer.update(sourceEl.value)
                }

                sourceEl.value = $('#initial')[0].innerHTML.trim()
                update()

                $('.render')[0].addEventListener('click', update)
            }())
        </script>
    </body>
</html>
